{"_id":"@apm-js-collab/tracing-hooks","_rev":"6-46c1318e056deb880f1c6e80881ed825","name":"@apm-js-collab/tracing-hooks","dist-tags":{"latest":"0.3.1"},"versions":{"0.0.1":{"name":"@apm-js-collab/tracing-hooks","version":"0.0.1","license":"Apache-2.0","_id":"@apm-js-collab/tracing-hooks@0.0.1","maintainers":[{"name":"timfish","email":"tim@timfish.uk"},{"name":"bizob2828","email":"robert.evans25@gmail.com"}],"homepage":"https://github.com/apm-js-collab/tracing-hooks#readme","bugs":{"url":"https://github.com/apm-js-collab/tracing-hooks/issues"},"dist":{"shasum":"38869afdf3224822ef4c23e102ef229ea97937e9","tarball":"https://registry.npmjs.org/@apm-js-collab/tracing-hooks/-/tracing-hooks-0.0.1.tgz","fileCount":5,"integrity":"sha512-3jXGTWknXOjo6pUJOF0gb9C5rDY31vOVsSbr5dJmqsh9EpTq4Z1AWqGgprzslq107o3g3n3xdtTObP676mn7OA==","signatures":[{"sig":"MEUCIBqE1VAKHTbznKnrt0f1554Gw2/9Ijle23HWX/jPEg5cAiEAqETO2E5OWFpMzH5qZDxEhZwpYxj6fYmmmcI9g+8tIiI=","keyid":"SHA256:DhQ8wR5APBvFHLF/+Tc+AYvPOdTpcIDqOhxsBHRwC7U"}],"unpackedSize":7755},"main":"index.js","type":"commonjs","engines":{"node":">=20"},"gitHead":"5acb9e58268b382ed87c3d5f9fced71d2d43073a","scripts":{"test":"c8 borp 'test/**/*.test.{js,mjs}'"},"_npmUser":{"name":"bizob2828","email":"robert.evans25@gmail.com"},"repository":{"url":"git+https://github.com/apm-js-collab/tracing-hooks.git","type":"git"},"_npmVersion":"11.5.1","description":"CJS and ESM hooks for orchestrion","directories":{},"_nodeVersion":"24.5.0","dependencies":{"debug":"^4.4.1","module-details-from-path":"^1.0.4","@apm-js-collab/code-transformer":"^0.6.0"},"_hasShrinkwrap":false,"devDependencies":{"c8":"^10.1.3","borp":"^0.20.1","@matteo.collina/snap":"^0.3.0"},"_npmOperationalInternal":{"tmp":"tmp/tracing-hooks_0.0.1_1755621190597_0.6745145552591432","host":"s3://npm-registry-packages-npm-production"}},"0.1.0":{"name":"@apm-js-collab/tracing-hooks","version":"0.1.0","license":"Apache-2.0","_id":"@apm-js-collab/tracing-hooks@0.1.0","maintainers":[{"name":"timfish","email":"tim@timfish.uk"},{"name":"bizob2828","email":"robert.evans25@gmail.com"}],"homepage":"https://github.com/apm-js-collab/tracing-hooks#readme","bugs":{"url":"https://github.com/apm-js-collab/tracing-hooks/issues"},"dist":{"shasum":"311c09599d9b040787c4c8093905f39432d7ab82","tarball":"https://registry.npmjs.org/@apm-js-collab/tracing-hooks/-/tracing-hooks-0.1.0.tgz","fileCount":6,"integrity":"sha512-cZPEZDr+HMFfN3uA4AQLiHXL75R2JmMj7IazwmAQT+K+5bf/8u1O9woZazb/cE1CTdL13uPd4CjcliWBaNhs7A==","signatures":[{"sig":"MEQCIFedVZ7CbxoMLNiPmNGbOjl45H3A8U6z39NmRgw+XhK/AiBOg8TYdtnG90EhPahsuh3HS3xNzzF/g52zL5TX6RI9hQ==","keyid":"SHA256:DhQ8wR5APBvFHLF/+Tc+AYvPOdTpcIDqOhxsBHRwC7U"}],"unpackedSize":19111},"main":"index.js","type":"commonjs","engines":{"node":">=20"},"gitHead":"051b422c845e3f39fb5b3c43540c18b57a82d9df","scripts":{"test":"c8 borp 'test/**/*.test.{js,mjs}'"},"_npmUser":{"name":"bizob2828","email":"robert.evans25@gmail.com"},"repository":{"url":"git+https://github.com/apm-js-collab/tracing-hooks.git","type":"git"},"_npmVersion":"11.5.1","description":"CJS and ESM hooks for orchestrion","directories":{},"_nodeVersion":"24.5.0","dependencies":{"debug":"^4.4.1","module-details-from-path":"^1.0.4","@apm-js-collab/code-transformer":"^0.6.0"},"_hasShrinkwrap":false,"devDependencies":{"c8":"^10.1.3","borp":"^0.20.1","@matteo.collina/snap":"^0.3.0"},"_npmOperationalInternal":{"tmp":"tmp/tracing-hooks_0.1.0_1755621809958_0.7009639513050079","host":"s3://npm-registry-packages-npm-production"}},"0.1.1":{"name":"@apm-js-collab/tracing-hooks","version":"0.1.1","license":"Apache-2.0","_id":"@apm-js-collab/tracing-hooks@0.1.1","maintainers":[{"name":"timfish","email":"tim@timfish.uk"},{"name":"bizob2828","email":"robert.evans25@gmail.com"}],"homepage":"https://github.com/apm-js-collab/tracing-hooks#readme","bugs":{"url":"https://github.com/apm-js-collab/tracing-hooks/issues"},"dist":{"shasum":"73f86cd18827e6d6253eda5322a6feb5753cfc58","tarball":"https://registry.npmjs.org/@apm-js-collab/tracing-hooks/-/tracing-hooks-0.1.1.tgz","fileCount":6,"integrity":"sha512-4s8fUde6La3n09m10Ol3zQXUaiDZyuzFKwvdEgbZVKT/XXqycFbqaKfut+UWOAs/yyiocK87MAC9C2JV51CpKg==","signatures":[{"sig":"MEQCIA7KqjCEkLc57YP0wK4nJ/FkZv7yo5ohYF76BV5CGQ8rAiAWbWJzKggxbJpvN82IWlE6CgF4OEsPBKMF32qJgnEPMw==","keyid":"SHA256:DhQ8wR5APBvFHLF/+Tc+AYvPOdTpcIDqOhxsBHRwC7U"}],"unpackedSize":19123},"main":"index.js","type":"commonjs","engines":{"node":">=20"},"gitHead":"7fce6e71b146057f213c72ae012774335154df25","scripts":{"test":"c8 borp 'test/**/*.test.{js,mjs}'"},"_npmUser":{"name":"bizob2828","email":"robert.evans25@gmail.com"},"repository":{"url":"git+https://github.com/apm-js-collab/tracing-hooks.git","type":"git"},"_npmVersion":"11.5.1","description":"CJS and ESM hooks for orchestrion","directories":{},"_nodeVersion":"24.5.0","dependencies":{"debug":"^4.4.1","module-details-from-path":"^1.0.4","@apm-js-collab/code-transformer":"^0.7.0"},"_hasShrinkwrap":false,"devDependencies":{"c8":"^10.1.3","borp":"^0.20.1","@matteo.collina/snap":"^0.3.0"},"_npmOperationalInternal":{"tmp":"tmp/tracing-hooks_0.1.1_1755790486059_0.3680358799461181","host":"s3://npm-registry-packages-npm-production"}},"0.2.0":{"name":"@apm-js-collab/tracing-hooks","version":"0.2.0","license":"Apache-2.0","_id":"@apm-js-collab/tracing-hooks@0.2.0","maintainers":[{"name":"timfish","email":"tim@timfish.uk"},{"name":"bizob2828","email":"robert.evans25@gmail.com"}],"homepage":"https://github.com/apm-js-collab/tracing-hooks#readme","bugs":{"url":"https://github.com/apm-js-collab/tracing-hooks/issues"},"dist":{"shasum":"b34f0857055895400e1ff0c15be5fd98cc378530","tarball":"https://registry.npmjs.org/@apm-js-collab/tracing-hooks/-/tracing-hooks-0.2.0.tgz","fileCount":6,"integrity":"sha512-tBTkPVXDRQa5wrH18UHqgGowHF33+v6B4LeixmaeBCpwOwnCjNs21lHZDlP8JAkvWLRBJ4O2zFLQnJk6B7IM+w==","signatures":[{"sig":"MEUCIFEgpnXtN8DgD4jm3SU8XeC6GgSQh3XPgPvpeg1Yg1TsAiEA8m/MMEpRaBKVmINzzvEC6RCjecnuuqNi1CHi51A4e1g=","keyid":"SHA256:DhQ8wR5APBvFHLF/+Tc+AYvPOdTpcIDqOhxsBHRwC7U"}],"attestations":{"url":"https://registry.npmjs.org/-/npm/v1/attestations/@apm-js-collab%2ftracing-hooks@0.2.0","provenance":{"predicateType":"https://slsa.dev/provenance/v1"}},"unpackedSize":19018},"main":"index.js","type":"commonjs","gitHead":"6811c091442dfc775b19fc4050255aa0fdf15ed9","scripts":{"test":"c8 borp 'test/**/*.test.{js,mjs}'"},"_npmUser":{"name":"GitHub Actions","email":"npm-oidc-no-reply@github.com","trustedPublisher":{"id":"github","oidcConfigId":"oidc:2173124c-17a7-449f-894b-09c848172ce5"}},"repository":{"url":"git+https://github.com/apm-js-collab/tracing-hooks.git","type":"git"},"_npmVersion":"11.6.0","description":"CJS and ESM hooks for orchestrion","directories":{},"_nodeVersion":"22.19.0","dependencies":{"debug":"^4.4.1","module-details-from-path":"^1.0.4","@apm-js-collab/code-transformer":"^0.7.0"},"_hasShrinkwrap":false,"devDependencies":{"c8":"^10.1.3","borp":"^0.20.1","@matteo.collina/snap":"^0.3.0"},"_npmOperationalInternal":{"tmp":"tmp/tracing-hooks_0.2.0_1757683276084_0.3401273988353717","host":"s3://npm-registry-packages-npm-production"}},"0.3.0":{"name":"@apm-js-collab/tracing-hooks","version":"0.3.0","license":"Apache-2.0","_id":"@apm-js-collab/tracing-hooks@0.3.0","maintainers":[{"name":"timfish","email":"tim@timfish.uk"},{"name":"bizob2828","email":"robert.evans25@gmail.com"}],"homepage":"https://github.com/apm-js-collab/tracing-hooks#readme","bugs":{"url":"https://github.com/apm-js-collab/tracing-hooks/issues"},"dist":{"shasum":"78522bdef95385b0fd31bdf9b2575947e88884f9","tarball":"https://registry.npmjs.org/@apm-js-collab/tracing-hooks/-/tracing-hooks-0.3.0.tgz","fileCount":6,"integrity":"sha512-YXyqZLr747VyFDd1g4UNBZlh1SSJfz8jMciVS46b+m5xb9Lnof75X5z8o7BeQfUudhhR6vtMCR9zKnBaPsmBDA==","signatures":[{"sig":"MEQCIB6e4JZcyhtZ717AhEcRlD5hogno2sqZKkES48shvxjsAiBj85/Xs8gH3yHo4ODAXxkTLOwlsh2WERAsorMpuNGvhA==","keyid":"SHA256:DhQ8wR5APBvFHLF/+Tc+AYvPOdTpcIDqOhxsBHRwC7U"}],"attestations":{"url":"https://registry.npmjs.org/-/npm/v1/attestations/@apm-js-collab%2ftracing-hooks@0.3.0","provenance":{"predicateType":"https://slsa.dev/provenance/v1"}},"unpackedSize":20428},"main":"index.js","type":"commonjs","gitHead":"428c8fec3621d8f2c3c9cc08798c0f17b8b9676b","scripts":{"test":"c8 borp 'test/**/*.test.{js,mjs}'"},"_npmUser":{"name":"GitHub Actions","email":"npm-oidc-no-reply@github.com","trustedPublisher":{"id":"github","oidcConfigId":"oidc:2173124c-17a7-449f-894b-09c848172ce5"}},"repository":{"url":"git+https://github.com/apm-js-collab/tracing-hooks.git","type":"git"},"_npmVersion":"11.6.0","description":"CJS and ESM hooks for orchestrion","directories":{},"_nodeVersion":"22.19.0","dependencies":{"debug":"^4.4.1","module-details-from-path":"^1.0.4","@apm-js-collab/code-transformer":"^0.8.0"},"_hasShrinkwrap":false,"devDependencies":{"c8":"^10.1.3","borp":"^0.20.1","@matteo.collina/snap":"^0.3.0"},"_npmOperationalInternal":{"tmp":"tmp/tracing-hooks_0.3.0_1758307717964_0.24590495523111944","host":"s3://npm-registry-packages-npm-production"}},"0.3.1":{"name":"@apm-js-collab/tracing-hooks","version":"0.3.1","description":"CJS and ESM hooks for orchestrion","license":"Apache-2.0","type":"commonjs","repository":{"type":"git","url":"git+https://github.com/apm-js-collab/tracing-hooks.git"},"main":"index.js","scripts":{"test":"c8 borp 'test/**/*.test.{js,mjs}'","test:update-snapshots":"SNAP_UPDATE=1 npm test"},"dependencies":{"@apm-js-collab/code-transformer":"^0.8.0","debug":"^4.4.1","module-details-from-path":"^1.0.4"},"devDependencies":{"@matteo.collina/snap":"^0.3.0","borp":"^0.20.1","c8":"^10.1.3"},"gitHead":"ca05de78d444de06a5982a6dfb124d1542a29153","_id":"@apm-js-collab/tracing-hooks@0.3.1","bugs":{"url":"https://github.com/apm-js-collab/tracing-hooks/issues"},"homepage":"https://github.com/apm-js-collab/tracing-hooks#readme","_nodeVersion":"22.19.0","_npmVersion":"11.6.1","dist":{"integrity":"sha512-Vu1CbmPURlN5fTboVuKMoJjbO5qcq9fA5YXpskx3dXe/zTBvjODFoerw+69rVBlRLrJpwPqSDqEuJDEKIrTldw==","shasum":"414d3a93c3a15d8be543a3fac561f7c602b6a588","tarball":"https://registry.npmjs.org/@apm-js-collab/tracing-hooks/-/tracing-hooks-0.3.1.tgz","fileCount":6,"unpackedSize":20097,"attestations":{"url":"https://registry.npmjs.org/-/npm/v1/attestations/@apm-js-collab%2ftracing-hooks@0.3.1","provenance":{"predicateType":"https://slsa.dev/provenance/v1"}},"signatures":[{"keyid":"SHA256:DhQ8wR5APBvFHLF/+Tc+AYvPOdTpcIDqOhxsBHRwC7U","sig":"MEQCIFi35doVtJshRPmPEnTznm9nNKQjgWvMyuEEPe+VwK01AiAgQpCFnL0gPAO/tJ2TpdOAmwj0MjVMkPSqxLXv4dMLHA=="}]},"_npmUser":{"name":"GitHub Actions","email":"npm-oidc-no-reply@github.com","trustedPublisher":{"id":"github","oidcConfigId":"oidc:2173124c-17a7-449f-894b-09c848172ce5"}},"directories":{},"maintainers":[{"name":"timfish","email":"tim@timfish.uk"},{"name":"bizob2828","email":"robert.evans25@gmail.com"}],"_npmOperationalInternal":{"host":"s3://npm-registry-packages-npm-production","tmp":"tmp/tracing-hooks_0.3.1_1758889353125_0.49154823229375477"},"_hasShrinkwrap":false}},"time":{"created":"2025-08-19T16:33:10.502Z","modified":"2025-09-26T12:22:33.740Z","0.0.1":"2025-08-19T16:33:10.792Z","0.1.0":"2025-08-19T16:43:30.159Z","0.1.1":"2025-08-21T15:34:46.263Z","0.2.0":"2025-09-12T13:21:16.261Z","0.3.0":"2025-09-19T18:48:38.155Z","0.3.1":"2025-09-26T12:22:33.302Z"},"bugs":{"url":"https://github.com/apm-js-collab/tracing-hooks/issues"},"license":"Apache-2.0","homepage":"https://github.com/apm-js-collab/tracing-hooks#readme","repository":{"type":"git","url":"git+https://github.com/apm-js-collab/tracing-hooks.git"},"description":"CJS and ESM hooks for orchestrion","maintainers":[{"name":"timfish","email":"tim@timfish.uk"},{"name":"bizob2828","email":"robert.evans25@gmail.com"}],"readme":"# Tracing Hooks\nThis repository contains a ESM loader for injecting tracing channel hooks into Node.js modules. It also has a patch for Module to be used to patch CJS modules.\n\n## Usage\n\nTo load esm loader:\n\n```js\n// esm-loader.mjs\nimport { register } from 'node:module';\nconst instrumentations = [\n  {\n    channelName: 'channel1',\n    module: { name: 'pkg1', verisonRange: '>=1.0.0', filePath: 'index.js' },\n    functionQuery: {\n      className: 'Class1',\n      methodName: 'method1', \n      kind: 'Async'\n    }\n  },\n  {\n    channelName: 'channel2',\n    module: { name: 'pkg2', verisonRange: '>=1.0.0', filePath: 'index.js' },\n    functionQuery: {\n      className: 'Class2,\n      methodName: 'method2', \n      kind: 'Sync'\n    }\n  }\n]\n\nregister('@apm-js-collab/tracing-hooks/hook.mjs', import.meta.url, {\n  data: { instrumentations }\n});\n```\n\nTo use the loader, you can run your Node.js application with the `--import` flag:\n\n```bash\nnode --import esm-loader.mjs your-app.js\n```\n\nTo load CJS patch:\n\n```js\n// cjs-patch.js\nconst ModulePatch = require('@apm-js-collab/tracing-hooks')\nconst instrumentations = [\n  {\n    channelName: 'channel1',\n    module: { name: 'pkg1', verisonRange: '>=1.0.0', filePath: 'index.js' },\n    functionQuery: {\n      className: 'Class1',\n      methodName: 'method1', \n      kind: 'Async'\n    }\n  },\n  {\n    channelName: 'channel2',\n    module: { name: 'pkg2', verisonRange: '>=1.0.0', filePath: 'index.js' },\n    functionQuery: {\n      className: 'Class2',\n      methodName: 'method2', \n      kind: 'Sync'\n    }\n  }\n]\n\n\nconst modulePatch = new ModulePatch({ instrumentations });\nmodulePatch.patch()\n```\n\nTo use the CJS patch you can run your Node.js application with the `--require` flag:\n\n```bash\nnode --require cjs-patch.js your-app.js\n```\n\n## Debugging\n\nThe [debug module](https://www.npmjs.com/package/debug) is used to provide\ninsight into the patching process. Set `DEBUG='@apm-js-collab*'` to view these\nlogs.\n\nAdditionally, any patched files can be written out by enabling dump mode. This\nis done by setting the environment variable `TRACING_DUMP` to any value. By\ndefault, it will write out file to the system's temporary directory as the\nparent directory. The target parent directory can be configured by setting\nthe `TRACING_DUMP_DIR` environment variable to an absolute path. In either\ncase, the resolved filename of the module being patched is appended. For\nexample, if we are patching `lib/index.js` in the `foo` package, and we set\na base directory of `/tmp/dump/`, then the patched code will be written to\n`/tmp/dump/foo/lib/index.js`.\n","readmeFilename":"README.md"}