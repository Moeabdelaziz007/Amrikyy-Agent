
> amrikyy-ai-os@0.0.0 test:backend:coverage
> NODE_OPTIONS=--experimental-vm-modules jest --config jest.config.backend.cjs --coverage

-----------------------------------|---------|----------|---------|---------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
File                               | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s
-----------------------------------|---------|----------|---------|---------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
All files                          |     3.4 |     0.54 |    1.25 |     3.5 |
 routes                            |    6.63 |     0.32 |    0.47 |    6.66 |
  agents.js                        |       0 |        0 |       0 |       0 | 1-477
  ai.js                            |       0 |        0 |       0 |       0 | 6-475
  analytics.js                     |       0 |        0 |       0 |       0 | 14-305
  api.js                           |       0 |        0 |       0 |       0 | 1-294
  auth.js                          |   32.81 |     12.5 |    12.5 |   32.81 | 31-40,50-58,68-76,86-99,113-117,127-143,175-188
  automation.js                    |       0 |        0 |       0 |       0 | 6-240
  bookings.js                      |   40.81 |    14.28 |   16.66 |   40.81 | 41,53-63,72-87,101-111,120-131,141-143
  cache.js                         |       0 |        0 |       0 |       0 | 6-220
  codebase-routes.js               |   19.48 |        0 |       0 |   19.48 | 27-41,49-63,82-110,122-143,155-172,188-209,221-232,244-255
  crypto-payments.js               |       0 |        0 |       0 |       0 | 6-470
  dashboard.js                     |       0 |        0 |       0 |       0 | 1-37
  destinations.js                  |       0 |        0 |       0 |       0 | 1-153
  discord.js                       |       0 |        0 |       0 |       0 | 6-234
  email.js                         |       0 |        0 |       0 |       0 | 6-302
  enhanced-ai.js                   |       0 |        0 |       0 |       0 | 8-586
  expenses.js                      |       0 |        0 |       0 |       0 | 1-149
  flights.js                       |       0 |        0 |       0 |       0 | 6-276
  hotels.js                        |       0 |        0 |       0 |       0 | 6-316
  ivr.js                           |       0 |        0 |       0 |       0 | 6-352
  mcp.js                           |       0 |      100 |       0 |       0 | 1-20
  messenger.js                     |       0 |        0 |       0 |       0 | 6-299
  mini-agents.js                   |   18.75 |        0 |       0 |   18.75 | 18-22,31-38,47-52,61-65,74-79,88-93,103-113,118-128,136-145,150-158,166-175,180-189,197-207,212-220,228-236,241-250,258-268,273-281,289-298,303-311,319-329,334-343,351-362,367-376,381-391,396-406,411-421,426-436,444-454,459-468,473-482,487-496,501-511,516-525
  mini-apps.js                     |       0 |        0 |       0 |       0 | 9-681
  miniapp.js                       |       0 |        0 |       0 |       0 | 11-491
  notebooklm.js                    |   17.28 |        0 |       0 |   17.28 | 24-47,59-71,83-100,112-129,141-160,176-208,220-241,257-278,294-303
  notifications.js                 |       0 |        0 |       0 |       0 | 1-163
  os.js                            |   21.89 |        0 |       0 |   21.89 | 42-61,65-73,77-91,101-109,129-136,153-174,189-196,209-233,248-263,278-286,301-309,324-332,347-355,369-377,392-402,420-431,447-465,480-486,498-504,519-525,540-546,559-571
  payment.js                       |       0 |        0 |       0 |       0 | 1-344
  profile.js                       |       0 |        0 |       0 |       0 | 1-87
  qdrant.js                        |       0 |        0 |       0 |       0 | 1-283
  revenue.js                       |       0 |        0 |       0 |       0 | 6-377
  sabre-routes.js                  |   16.55 |        0 |       0 |   16.55 | 19-51,63-80,92-109,121-138,150-160,172-182,194-202,214-244,256-273,285-302,314-331,343-353,365-375,387-395,407-437,449-466,478-495,507-524,536-546,558-568,580-588
  security.js                      |       0 |        0 |       0 |       0 | 6-164
  seo-routes.js                    |   17.88 |        0 |       0 |   17.88 | 53-78,89-110,122-143,155-164,176-187,199-210,222-239,251-268,280-288,300-311,323-331,343-354,366-382
  smart-documentation.js           |       0 |        0 |       0 |       0 | 1-318
  stripe-webhook.js                |    10.6 |        0 |       0 |    10.6 | 21-258
  supabaseClient.js                |       0 |        0 |     100 |       0 | 1-10
  telegram-integration.js          |       0 |        0 |       0 |       0 | 6-287
  travel-agents.js                 |       0 |        0 |       0 |       0 | 6-135
  trips.js                         |       0 |        0 |       0 |       0 | 1-134
  vault-routes.js                  |   20.61 |        0 |       0 |   20.61 | 20-47,59-73,85-95,107-117,129-146,158-166,178-195,207-215,227-248,260-268,280-288,300-317,329-346,358-359,370-371
  voice.js                         |   25.53 |        0 |       0 |   25.53 | 26-51,63-85,97-107,119-133,145-159,171-181
  voice_note_taker.js              |       0 |      100 |       0 |       0 | 1-10
  web-explorer.js                  |       0 |        0 |       0 |       0 | 1-109
  whatsapp.js                      |       0 |        0 |       0 |       0 | 9-85
  youtube-automation.js            |   18.18 |        0 |       0 |   18.18 | 24-41,58-82,99-122,139-162,179-201,218-254,271-282,299-315,332-340
  youtube.js                       |       0 |        0 |       0 |       0 | 2-70
 services                          |    3.06 |     0.49 |    1.69 |    3.13 |
  GoogleMapsService.js             |       0 |        0 |       0 |       0 | 2-140
  TelegramService.js               |       0 |        0 |       0 |       0 | 2-64
  TranslateService.js              |       0 |        0 |       0 |       0 | 2-91
  VeoService.js                    |       0 |        0 |       0 |       0 | 2-104
  WebAnalysisService.js            |       0 |        0 |       0 |       0 | 2-175
  YouTubeService.js                |       0 |        0 |       0 |       0 | 2-114
  agentOrchestrator.js             |       0 |        0 |       0 |       0 | 2-37
  aixExecutor.js                   |       0 |      100 |       0 |       0 | 2-53
  aixParser.js                     |       0 |        0 |       0 |       0 | 16-49
  authService.js                   |    4.25 |        0 |       0 |    4.25 | 32-557
  bookingService.js                |    6.03 |        0 |       0 |    6.03 | 36-512
  chatEngine.js                    |       0 |      100 |       0 |       0 | 15-19
  conversationMemory.js            |       0 |      100 |       0 |       0 | 15-31
  emailService.js                  |   14.81 |     3.44 |    8.33 |   14.81 | 38-575
  geminiService.js                 |       0 |        0 |       0 |       0 | 2-39
  quantumRewardEngine.js           |       0 |        0 |       0 |       0 | 27-887
  stripeService.js                 |    7.22 |        0 |    12.5 |    7.22 | 28-323
 services/automation               |       0 |        0 |       0 |       0 |
  GeminiCLI.js                     |       0 |        0 |       0 |       0 | 7-553
  IntakeAnalyzer.js                |       0 |        0 |       0 |       0 | 7-403
 src                               |       0 |        0 |       0 |       0 |
  app.js                           |       0 |        0 |       0 |       0 | 10-289
 src/agents                        |    1.63 |     0.52 |    0.64 |    1.69 |
  AIEducationAgent.js              |       0 |        0 |       0 |       0 | 6-629
  AgentCoordinator.js              |       0 |        0 |       0 |       0 | 7-420
  ContentCreatorAgent.js           |   13.22 |     4.16 |    8.33 |   13.44 | 110-680
  EmotionalAnalyzer.js             |       0 |        0 |       0 |       0 | 8-496
  EmotionalMemorySystem.js         |       0 |        0 |       0 |       0 | 8-615
  EnhancedTravelAgent.example.js   |       0 |        0 |       0 |       0 | 11-303
  GeminiQuantopoCodex.js           |       0 |        0 |       0 |       0 | 7-917
  GeminiSuperpowers.js             |       0 |        0 |       0 |       0 | 7-475
  InnovationAgent.js               |       0 |        0 |       0 |       0 | 24-700
  KarimWithMCP.js                  |       0 |        0 |       0 |       0 | 6-303
  LangSmithIntegration.js          |       0 |      100 |       0 |       0 | 5-206
  LunaWithMCP.js                   |       0 |        0 |       0 |       0 | 6-319
  QuantumGeminiCore.js             |       0 |        0 |       0 |       0 | 7-490
  ScoutWithMCP.js                  |       0 |        0 |       0 |       0 | 6-457
  TravelAgencyAgent.js             |   12.09 |     6.25 |    7.14 |   12.19 | 89-672
  mini-aladdin.js                  |       0 |        0 |       0 |       0 | 6-385
 src/agents/mini                   |       0 |        0 |       0 |       0 |
  CodingAgent.js                   |       0 |        0 |       0 |       0 | 20-529
  CommunicatorAgent.js             |       0 |        0 |       0 |       0 | 6-214
  MarketingAgent.js                |       0 |        0 |       0 |       0 | 20-409
  MediaAgent.js                    |       0 |        0 |       0 |       0 | 6-260
  NavigatorAgent.js                |       0 |        0 |       0 |       0 | 1-71
  ResearchAgent.js                 |       0 |        0 |       0 |       0 | 6-240
  SchedulerAgent.js                |       0 |        0 |       0 |       0 | 6-196
  StorageAgent.js                  |       0 |        0 |       0 |       0 | 6-235
  TranslatorAgent.js               |       0 |        0 |       0 |       0 | 6-241
  VisionAgent.js                   |       0 |        0 |       0 |       0 | 6-230
 src/ai                            |       0 |        0 |       0 |       0 |
  EnhancedModelSwitcher.js         |       0 |        0 |       0 |       0 | 8-119
  amrikyyPersona.js                |       0 |        0 |       0 |       0 | 8-428
  contextManager.js                |       0 |        0 |       0 |       0 | 8-198
  culture.js                       |       0 |        0 |       0 |       0 | 6-57
  geminiClient.js                  |       0 |        0 |       0 |       0 | 7-271
  keloClient.js                    |       0 |        0 |       0 |       0 | 8-75
  mcpTools.js                      |       0 |        0 |       0 |       0 | 6-890
  modelSwitcher.js                 |       0 |        0 |       0 |       0 | 8-293
  moonshotClient.js                |       0 |        0 |       0 |       0 | 7-249
  openRouterClient.js              |       0 |        0 |       0 |       0 | 7-471
  tools.js                         |       0 |        0 |       0 |       0 | 1-97
  userProfiling.js                 |       0 |        0 |       0 |       0 | 8-474
  zaiClient.js                     |       0 |        0 |       0 |       0 | 6-384
 src/aix                           |       0 |      100 |     100 |       0 |
  AIXConnectionManager.js          |       0 |      100 |     100 |       0 | 2
 src/analytics                     |       0 |        0 |       0 |       0 |
  DataCollector.js                 |       0 |        0 |       0 |       0 | 15-587
  LangSmithAnalytics.js            |       0 |        0 |       0 |       0 | 4-106
  dashboard.js                     |       0 |        0 |       0 |       0 | 8-387
 src/cache                         |     8.9 |     2.94 |    8.19 |    9.25 |
  IntelligentCache.js              |       0 |        0 |       0 |       0 | 6-128
  MemoryCache.js                   |   13.08 |      2.5 |   18.75 |   13.46 | 38-40,62-273
  RedisCache.js                    |    9.04 |     4.34 |    5.26 |    9.55 | 62-520
 src/config                        |       0 |        0 |     100 |       0 |
  langsmith-config.js              |       0 |        0 |     100 |       0 | 3-14
 src/controllers                   |   18.42 |        0 |       0 |   18.42 |
  coordinatorController.js         |   10.34 |        0 |       0 |   10.34 | 29-144
  streamController.js              |    23.4 |        0 |       0 |    23.4 | 43-102,116-138
 src/crypto                        |       0 |        0 |       0 |       0 |
  CryptoPaymentManager.js          |       0 |        0 |       0 |       0 | 14-591
 src/examples                      |       0 |        0 |       0 |       0 |
  agentManagement.example.js       |       0 |        0 |       0 |       0 | 9-275
  middlewareIntegration.example.js |       0 |        0 |       0 |       0 | 9-370
 src/mcp                           |       0 |        0 |       0 |       0 |
  ChatHistoryIndexer.js            |       0 |        0 |       0 |       0 | 6-454
  EducationMCPServer.js            |       0 |        0 |       0 |       0 | 6-660
  TravelMCPServer.js               |       0 |        0 |       0 |       0 | 7-570
 src/memory                        |       0 |        0 |       0 |       0 |
  KnowledgeGraph.js                |       0 |        0 |       0 |       0 | 6-825
  SemanticSearchEngine.js          |       0 |        0 |       0 |       0 | 6-892
  SmartMemoryManager.js            |       0 |        0 |       0 |       0 | 6-997
  VectorMemorySystem.js            |       0 |        0 |       0 |       0 | 6-658
 src/middleware                    |   14.34 |        0 |    5.12 |    14.4 |
  agentAuth.js                     |       0 |        0 |       0 |       0 | 16-388
  agentRateLimit.js                |       0 |        0 |       0 |       0 | 16-357
  agentValidation.js               |   31.57 |        0 |      25 |   32.14 | 149-191,247-261,275-331
  validation.js                    |   51.42 |        0 |       0 |   51.42 | 23-42,347-366
 src/monitoring                    |       2 |        0 |    2.15 |     2.1 |
  ConsolidatedMonitor.js           |   24.24 |        0 |   14.28 |   24.24 | 16-37,46-61,80-108
  ImprovementEngine.js             |       0 |        0 |       0 |       0 | 13-624
  LangSmithMonitor.js              |       0 |        0 |       0 |       0 | 5-118
  PerformanceMonitor.js            |       0 |        0 |       0 |       0 | 6-104
  SmartHealthMonitor.js            |       0 |        0 |       0 |       0 | 13-628
 src/nlp                           |       0 |        0 |       0 |       0 |
  ArabicNLPipeline.js              |       0 |        0 |       0 |       0 | 8-929
 src/optimization                  |       0 |        0 |       0 |       0 |
  PerformanceOptimizer.js          |       0 |        0 |       0 |       0 | 14-242
  PromptOptimizer.js               |       0 |        0 |       0 |       0 | 4-140
 src/os                            |    18.5 |    14.86 |   16.12 |   18.18 |
  AIOperatingSystem.js             |    18.5 |    14.86 |   16.12 |   18.18 | 81-82,116-117,218-758
 src/reward                        |       0 |        0 |       0 |       0 |
  QuantumRewardEngine.js           |       0 |        0 |       0 |       0 | 20-734
  RewardIntegration.js             |       0 |        0 |       0 |       0 | 6-208
 src/routes                        |     9.1 |        0 |       0 |    9.33 |
  agentManagement.js               |       0 |        0 |       0 |       0 | 20-513
  agents.js                        |       0 |        0 |       0 |       0 |
  aladdin.js                       |       0 |        0 |       0 |       0 | 6-241
  coordinator.js                   |   23.45 |        0 |       0 |   23.45 | 45-65,81-101,117-143,159-179,193-211,223-241,253-261,273-281
  health.js                        |   14.73 |        0 |       0 |   16.09 | 28-180,188-238,251,262-279,292
  metrics.js                       |   15.38 |        0 |       0 |   15.68 | 18-23,35-42,54-60,69-273
  reward.js                        |       0 |        0 |       0 |       0 | 6-291
  streamRoutes.js                  |     100 |      100 |     100 |     100 |
 src/scripts                       |       0 |        0 |       0 |       0 |
  initializeAIOS.js                |       0 |        0 |       0 |       0 | 16-344
 src/security                      |       0 |        0 |       0 |       0 |
  SecurityManager.js               |       0 |        0 |       0 |       0 | 14-415
  TokenManager.js                  |       0 |        0 |       0 |       0 | 6-279
  envValidator.js                  |       0 |        0 |       0 |       0 | 6-257
  securityLogger.js                |       0 |        0 |       0 |       0 | 6-202
 src/services                      |    5.92 |     1.33 |    3.68 |    6.14 |
  AgentOrchestrator.js             |   16.21 |     5.88 |   33.33 |   16.21 | 17-18,26-217
  BookingComService.js             |       0 |        0 |       0 |       0 | 6-418
  CodebaseIndexer.js               |    5.83 |        0 |       0 |    6.14 | 24-357
  ContentChunker.js                |       0 |        0 |       0 |       0 | 10-32
  ContentExtractor.js              |       0 |        0 |       0 |       0 | 1-84
  EncryptionService.js             |      16 |    45.45 |   11.76 |      16 | 37-38,53-265
  EnhancedHealthMonitor.js         |       0 |        0 |       0 |       0 | 14-312
  ExplorerQueue.js                 |       0 |        0 |       0 |       0 | 1-33
  GeminiComputerControlService.js  |       0 |        0 |       0 |       0 | 8-630
  GoogleMapsService.js             |    6.66 |     1.25 |       4 |    6.77 | 56-548
  GoogleVisionService.js           |       0 |        0 |       0 |       0 | 1-53
  KiwiTequilaService.js            |       0 |        0 |       0 |       0 | 6-295
  LLMService.js                    |       0 |        0 |       0 |       0 | 1-76
  MCPServerManager.js              |       0 |        0 |       0 |       0 | 6-124
  MapboxService.js                 |       0 |        0 |       0 |       0 | 6-372
  NotebookLMService.js             |    8.33 |        0 |    5.55 |    8.33 | 61-511
  PromptBuilder.js                 |       0 |      100 |       0 |       0 | 3-27
  RealDataIntegration.js           |       0 |        0 |       0 |       0 | 7-346
  SEOMonitor.js                    |    2.32 |        0 |       0 |    2.53 | 19-363
  SabreService.js                  |    7.27 |     4.87 |    4.34 |     7.4 | 34-535
  SearchService.js                 |       0 |        0 |       0 |       0 | 1-80
  SecureVaultService.js            |    7.69 |     7.31 |    4.54 |    8.41 | 31-33,50-389
  SemanticSearch.js                |    2.85 |        0 |       0 |    3.12 | 20-250
  SitemapGenerator.js              |    4.65 |        0 |       0 |    5.12 | 20-239
  UnifiedPaymentService.js         |       0 |        0 |       0 |       0 | 22-613
  VoiceService.js                  |   15.11 |     3.22 |   13.33 |   16.25 | 35-37,43-302
  WeChatNotifier.js                |       0 |        0 |       0 |       0 | 14-208
  WebAnalysisService.js            |       0 |        0 |       0 |       0 | 1-119
  YouTubeAutomationService.js      |   13.48 |     1.53 |    7.69 |   13.71 | 57,75-735
  authService.js                   |       0 |        0 |       0 |       0 | 6-219
  bookingService.js                |       0 |        0 |       0 |       0 | 6-272
  coordinatorService.js            |   24.32 |        0 |   33.33 |   24.32 | 31-125,143-154
  metricsService.js                |   52.38 |     12.5 |      25 |   52.38 | 174-182,200-290
  qdrantService.js                 |       0 |        0 |       0 |       0 | 1-290
  revenueAnalytics.js              |       0 |        0 |       0 |       0 | 6-483
  streamService.js                 |   11.45 |        0 |   11.11 |   11.45 | 12-13,61-299
  stripeService.js                 |       0 |        0 |       0 |       0 | 6-248
 src/telegram                      |       0 |        0 |       0 |       0 |
  LLMTelegramBot.js                |       0 |        0 |       0 |       0 | 6-348
 src/tools                         |       0 |        0 |       0 |       0 |
  BaseTool.js                      |       0 |        0 |       0 |       0 | 10-99
  ChatIndexer.js                   |       0 |        0 |       0 |       0 | 6-1825
  CodeScanner.js                   |       0 |        0 |       0 |       0 | 6-1015
  CodebaseIndexer.js               |       0 |        0 |       0 |       0 | 6-1618
  ComprehensiveScanner.js          |       0 |        0 |       0 |       0 | 6-782
  EnhancedQuantumExplorerTool.js   |       0 |        0 |       0 |       0 | 1-730
  QuantumExplorerTool.js           |       0 |        0 |       0 |       0 | 1-77
  execute_notebook_code.js         |       0 |        0 |       0 |       0 | 6-122
  find_flight_deals.js             |       0 |        0 |       0 |       0 | 7-58
  generate_marketing_image.js      |       0 |      100 |       0 |       0 | 7-47
  generate_proactive_offers.js     |       0 |        0 |       0 |       0 | 9-482
  geolocation.js                   |       0 |        0 |       0 |       0 | 8-46
  index.js                         |       0 |        0 |       0 |       0 | 9-116
  monitor_user_interests.js        |       0 |        0 |       0 |       0 | 9-253
  proactive_marketing_workflow.js  |       0 |        0 |       0 |       0 | 8-87
  track_price_changes.js           |       0 |        0 |       0 |       0 | 9-421
 src/tools/jupyter                 |       0 |        0 |       0 |       0 |
  JupyterManagerFixed.js           |       0 |        0 |       0 |       0 | 6-194
 src/tracking                      |       0 |        0 |       0 |       0 |
  GeminiWorkTracker.js             |       0 |        0 |       0 |       0 | 8-442
 src/utils                         |    3.15 |     1.25 |     2.2 |    3.24 |
  AgentCacheManager.js             |       0 |        0 |       0 |       0 | 16-418
  AgentErrorHandler.js             |       0 |        0 |       0 |       0 | 15-364
  AgentLangSmith.js                |    4.05 |      3.5 |    3.12 |    4.07 | 118-848
  AgentMCPIntegration.js           |       0 |        0 |       0 |       0 | 16-451
  AgentStreaming.js                |     4.6 |        0 |    4.76 |     4.6 | 41-482
  MultiAgentCoordinator.js         |    5.88 |        0 |    5.26 |    6.01 | 48-467
  langsmith_helpers.js             |   13.72 |        0 |       0 |   14.28 | 13,48-308
  logger.js                        |   33.33 |    16.66 |   14.28 |   33.33 | 13-33
  revenueCalculator.js             |       0 |        0 |       0 |       0 | 19-337
  supabaseClient.js                |       0 |        0 |     100 |       0 | 1-18
 src/websocket                     |       0 |        0 |       0 |       0 |
  chatHandler.js                   |       0 |        0 |       0 |       0 | 6-209
  workflowHandler.js               |       0 |        0 |       0 |       0 | 1-399
 src/whatsapp                      |       0 |        0 |       0 |       0 |
  whatsappClient.js                |       0 |        0 |       0 |       0 | 6-305
-----------------------------------|---------|----------|---------|---------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
